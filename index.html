<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">

<meta name="viewport"
content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

<title>Rabika's Burguer</title>

<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700;800;900&display=swap" rel="stylesheet">

<style>
*{
  box-sizing:border-box;
  margin:0;
  padding:0;
  touch-action:manipulation;
}

body{
  font-family:'Poppins',sans-serif;
  background:linear-gradient(180deg,#06003a,#0a045a,#03001f);
  color:#fff;
  display:flex;
  justify-content:center;
  min-height:100vh;
}

/* SPLASH */
#splash{
  position:fixed;
  inset:0;
  background:linear-gradient(180deg,#05002e,#020018);
  display:flex;
  align-items:center;
  justify-content:center;
  z-index:9999;
}
.splash-box{
  display:flex;
  flex-direction:column;
  align-items:center;
}
.splash-logo{
  width:85vw;
  max-width:380px;
  margin-bottom:24px;
}
.splash-btn{
  background:#FFD34D;
  border:none;
  padding:18px 60px;
  border-radius:50px;
  font-size:20px;
  font-weight:900;
  color:#2b0033;
}

/* APP */
#app{
  width:100%;
  max-width:480px;
  padding:14px 14px 380px;
  display:none;
}

/* MODAL BASE */
.modal{
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.6);
  display:none;
  align-items:center;
  justify-content:center;
  z-index:10000;
}

/* PAINEL ADM */
#adminModal .modal-box{
  background:#fff;
  color:#2b0033;
  width:94%;
  max-width:420px;
  max-height:90vh;
  border-radius:28px;
  padding:16px;
  display:flex;
  flex-direction:column;
}

.admin-header{
  display:flex;
  justify-content:space-between;
  align-items:center;
  margin-bottom:10px;
}

.admin-header h3{
  font-size:18px;
  font-weight:900;
}

.admin-close{
  background:#b00020;
  color:#fff;
  border:none;
  border-radius:50%;
  width:32px;
  height:32px;
  font-weight:900;
}

#adminList{
  overflow-y:auto;
  flex:1;
  padding-right:6px;
}

.admin-row{
  display:grid;
  grid-template-columns:1fr 90px 110px 44px;
  gap:6px;
  align-items:center;
  margin-bottom:8px;
}

.admin-row input{
  padding:8px;
  border-radius:10px;
  border:1px solid #ccc;
  font-size:12px;
}

.admin-row button{
  background:#5a0070;
  color:#fff;
  border:none;
  border-radius:10px;
  padding:6px;
  font-weight:800;
  cursor:pointer;
}
</style>
</head>
<body>
<!-- SPLASH -->
<div id="splash">
  <div class="splash-box">
    <img src="logo.png" class="splash-logo">
    <button class="splash-btn" onclick="start()">FAZER PEDIDO</button>
  </div>
</div>

<!-- APP -->
<div id="app">
  <div class="title">Rabika's Burguer</div>
  <div id="closedBanner">üî¥ Estamos fechados ‚Äî Ter√ßa a Domingo das 18:30 √†s 22:30</div>

  <input
    class="search"
    id="search"
    placeholder="Pesquisar no card√°pio..."
    onkeyup="handleSearch(this.value)"
  >

  <div class="tabs">
    <div class="tab active" onclick="openTab('lanches',this)">üçî Lanches</div>
    <div class="tab" onclick="openTab('porcoes',this)">üçü Por√ß√µes</div>
    <div class="tab" onclick="openTab('pasteis',this)">ü•ü Past√©is</div>
    <div class="tab" onclick="openTab('acai',this)">üç® A√ßa√≠</div>
    <div class="tab" onclick="openTab('bebidas',this)">ü•§ Bebidas</div>
  </div>

  <div id="lanches" class="box active"></div>
  <div id="porcoes" class="box"></div>
  <div id="pasteis" class="box"></div>
  <div id="acai" class="box"></div>
  <div id="bebidas" class="box"></div>
</div>

<!-- CARRINHO -->
<div id="cart">
  <div id="cartItems"></div>

  <div class="delivery">
    <label>
      <input type="radio" name="del" checked onclick="setDelivery(false)">
      Retirada
    </label>
    <label>
      <input type="radio" name="del" onclick="setDelivery(true)">
      Entrega (+R$8)
    </label>
  </div>

  <input class="input" id="name" placeholder="Seu nome">
  <input
    class="input"
    id="address"
    placeholder="Endere√ßo"
    style="display:none"
  >

  <select class="select" id="payment">
    <option value="">Forma de pagamento</option>
    <option>Dinheiro</option>
    <option>Pix</option>
    <option>Cart√£o</option>
  </select>

  <div class="total" id="total">Total: R$ 0,00</div>
  <div class="finish" onclick="tryFinishOrder()">Finalizar Pedido</div>
</div>

<!-- MODAL BEBIDA -->
<div id="drinkModal" class="modal">
  <div class="modal-box">
    <h3 style="text-align:center">ü•§ Vai querer bebida?</h3>
    <p style="text-align:center;font-size:14px;margin:10px 0">
      Que tal adicionar uma bebida para acompanhar seu pedido?
    </p>

    <div style="display:flex;gap:10px">
      <button class="finish" onclick="openDrinks()">SIM</button>
      <button class="btn-add" onclick="skipDrinks()">N√ÉO</button>
    </div>
  </div>
</div>

<!-- PAINEL ADM -->
<div id="adminModal" class="modal">
  <div class="modal-box">

    <div class="admin-header">
      <h3>Painel de Ofertas</h3>
      <button class="admin-close" onclick="closeAdmin()">‚úï</button>
    </div>

    <p style="font-size:13px;text-align:center;margin-bottom:8px">
      Defina o pre√ßo promocional e a data final da oferta
    </p>

    <div id="adminList"></div>

  </div>
</div>
<script>
/* ================= CONFIG ================= */
const FREIGHT = 8;
const ADMIN_KEY = "oferta";

let cart = [];
let isDelivery = false;
let offers = JSON.parse(localStorage.getItem("offers")) || {};

/* ================= HOR√ÅRIO ================= */
function isOpenNow(){
  const d = new Date();
  const day = d.getDay(); // 0 dom, 1 seg
  const time = d.getHours() + d.getMinutes()/60;

  if(day === 1) return false;               // segunda fechado
  if(time < 18.5 || time > 22.5) return false; // 18:30 √†s 22:30
  return true;
}

/* ================= PRODUTOS ================= */
const products = {
  lanches:[
    {n:'X-Salada',p:17},{n:'X-Burguer',p:14},{n:'X-Frango',p:22},
    {n:'X-Frango Cremoso',p:20},{n:'X-Bacon',p:25},{n:'X-Calabresa',p:25},
    {n:'X-Cora√ß√£o',p:27},{n:'X-Tudo',p:32},{n:'X-Burguer Duplo',p:22},
    {n:'X-Egg',p:20},{n:'X-Tribom',p:32},{n:'X-Da Casa',p:45},{n:'X-Dog',p:20}
  ],
  adicionais:[
    {n:'Calabresa',p:7},{n:'Bacon',p:7},{n:'Cora√ß√£o',p:8},
    {n:'Ovo',p:3},{n:'Salsicha',p:4},{n:'Frango',p:7},
    {n:'Cheddar',p:4},{n:'Hamb√∫rguer artesanal',p:10},{n:'Maionese caseira',p:2}
  ],
  porcoes:[
    {n:'Fritas',p:24.99},{n:'Fritas c/ Frango',p:39.99},
    {n:'Fritas c/ Calabresa',p:34.99},{n:'Fritas c/ Bacon',p:34.99},
    {n:'An√©is de Cebola',p:24.99},
    {n:'Fritas c/ Bacon, Calabresa e Queijo',p:39.99},
    {n:'Fritas c/ Bacon Cheddar',p:39.99},
    {n:'Fritas c/ Polenta e Frango',p:39.99},
    {n:'Fritas c/ Polenta',p:24.99},
    {n:'Fritas c/ Calabresa e Catupiry',p:35.99},
    {n:'Fritas, Polenta, Chuleta e Anel de Cebola',p:49.99}
  ],
  pasteis:[
    {n:'Pastel de Carne',p:14},{n:'Pastel de Frango',p:12},
    {n:'Frango Bacon Cheddar',p:16},{n:'Bacon Cheddar',p:15},
    {n:'Calabresa c/ Cebola',p:14},{n:'Carne e Queijo',p:15},
    {n:'Queijo',p:14},{n:'Chocolate ao Leite',p:15},
    {n:'Banana Queijo Canela',p:15},{n:'Romeu e Julieta',p:15},
    {n:'Chocolate Branco',p:15},{n:'Creme e Ouro Branco',p:15},
    {n:'Creme e Sonho de Valsa',p:15}
  ],
  acaiT:[
    {n:'A√ßa√≠ 300ml',p:12},{n:'A√ßa√≠ 400ml',p:15},{n:'A√ßa√≠ 500ml',p:18}
  ],
  acaiA:[
    {n:'Pa√ßoca',p:2},{n:'Leite em p√≥',p:4},{n:'Granola',p:4},
    {n:'Morango',p:4},{n:'M&M',p:3},{n:'Ouro Branco',p:3},
    {n:'Banana',p:2},{n:'Sonho de Valsa',p:3},
    {n:'Leite Condensado',p:3},{n:'Nutella',p:4}
  ],
  bebidas:[
    {n:'Cassulinha 200ml',p:3},{n:'Coca-Cola 600ml',p:8},
    {n:'Coca-Cola 2L',p:16},{n:'Refri Lata',p:6},
    {n:'Refrigerante 2L',p:12},{n:'Cerveja Lata 350ml',p:6},
    {n:'Achocolatado 200ml',p:3}
  ]
};

/* ================= START ================= */
function start(){
  document.getElementById("splash").style.display="none";
  document.getElementById("app").style.display="block";
  normalizeOffers();
  renderAll();
  updateOpenStatus();
}

/* ================= STATUS ================= */
function updateOpenStatus(){
  document.getElementById("closedBanner").style.display =
    isOpenNow() ? "none" : "block";
}

/* ================= RENDER ================= */
function renderAll(){
  renderCategory("lanches",products.lanches,products.adicionais);
  renderCategory("porcoes",products.porcoes);
  renderCategory("pasteis",products.pasteis);
  renderAcai();
  renderCategory("bebidas",products.bebidas);
  renderAdmin();
}

function itemHTML(p){
  const offer = offers[p.n];
  const price = offer ? offer.price : p.p;
  const disabled = !isOpenNow() ? "disabled" : "";

  return `
  <div class="item" data-name="${p.n.toLowerCase()}">
    <span class="item-name">${p.n}</span>
    <span class="item-price">
      ${offer ? `<span class="old">R$ ${p.p.toFixed(2).replace('.',',')}</span><br>` : ``}
      R$ ${price.toFixed(2).replace('.',',')}
    </span>
    <button class="btn-add" ${disabled} onclick="addItem('${p.n}',${price})">+</button>
  </div>`;
}

function renderCategory(id,list,extra){
  const box=document.getElementById(id);
  box.innerHTML="";
  list.forEach(p=>box.innerHTML+=itemHTML(p));
  if(extra){
    box.innerHTML+=`<div class="section">‚ûï Adicionais</div>`;
    extra.forEach(p=>box.innerHTML+=itemHTML(p));
  }
}

function renderAcai(){
  const box=document.getElementById("acai");
  box.innerHTML=`<div class="section">ü•§ Tamanhos</div>`;
  products.acaiT.forEach(p=>box.innerHTML+=itemHTML(p));
  box.innerHTML+=`<div class="section">üç´ Adicionais</div>`;
  products.acaiA.forEach(p=>box.innerHTML+=itemHTML(p));
}

/* ================= BUSCA GLOBAL ================= */
function handleSearch(v){
  v=v.toLowerCase().trim();

  if(v===ADMIN_KEY){
    openAdmin();
    document.getElementById("search").value="";
    return;
  }

  if(!v){
    renderAll();
    return;
  }

  let first=null;
  document.querySelectorAll(".box").forEach(box=>{
    let found=false;
    box.querySelectorAll(".item").forEach(i=>{
      const match=i.dataset.name.includes(v);
      i.style.display=match?"grid":"none";
      if(match) found=true;
    });
    if(found && !first) first=box.id;
  });

  if(first){
    document.querySelectorAll(".box").forEach(b=>b.classList.remove("active"));
    document.getElementById(first).classList.add("active");
  }
}

/* ================= CARRINHO ================= */
function addItem(n,p){
  if(!isOpenNow()){
    alert("‚è∞ Estamos fechados.\nTer√ßa a Domingo das 18:30 √†s 22:30");
    return;
  }
  cart.push({n,p,q:1});
  updateCart();
}

function updateCart(){
  const box=document.getElementById("cartItems");
  box.innerHTML="";
  let total=0;

  cart.forEach((i,idx)=>{
    total+=i.p*i.q;
    box.innerHTML+=`
    <div class="cart-item">
      <span>${i.n} x${i.q}</span>
      <div class="qty">
        <button onclick="chg(${idx},-1)">-</button>
        <button onclick="chg(${idx},1)">+</button>
      </div>
    </div>`;
  });

  if(isDelivery) total+=FREIGHT;
  document.getElementById("total").innerText =
    "Total: R$ "+total.toFixed(2).replace('.',',');

  document.getElementById("cart").style.display = cart.length?"block":"none";
}

function chg(i,v){
  cart[i].q+=v;
  if(cart[i].q<=0) cart.splice(i,1);
  updateCart();
}

function setDelivery(v){
  isDelivery=v;
  document.getElementById("address").style.display=v?"block":"none";
  updateCart();
}

/* ================= ADMIN ================= */
function openAdmin(){
  document.getElementById("adminModal").style.display="flex";
  renderAdmin();
}

function closeAdmin(){
  document.getElementById("adminModal").style.display="none";
}

function normalizeOffers(){
  const today = new Date().toISOString().split("T")[0];
  Object.keys(offers).forEach(k=>{
    if(offers[k].expires && offers[k].expires < today){
      delete offers[k];
    }
  });
  localStorage.setItem("offers",JSON.stringify(offers));
}

function renderAdmin(){
  const list=document.getElementById("adminList");
  if(!list) return;
  list.innerHTML="";

  Object.values(products).flat().forEach(p=>{
    list.innerHTML+=`
    <div class="admin-row">
      <input value="${p.n}" readonly>
      <input type="number" placeholder="Pre√ßo oferta" id="of-${p.n}">
      <input type="date" id="dt-${p.n}">
      <button onclick="applyOffer('${p.n}',${p.p})">OK</button>
    </div>`;
  });
}

function applyOffer(name,original){
  const price=document.getElementById("of-"+name).value;
  const date=document.getElementById("dt-"+name).value;
  if(!price) return;

  offers[name]={price:parseFloat(price),original,expires:date};
  localStorage.setItem("offers",JSON.stringify(offers));
  renderAll();
}

/* ================= BEBIDA ================= */
function hasFood(){
  return cart.some(i=>products.lanches.some(l=>l.n===i.n));
}
function hasDrink(){
  return cart.some(i=>products.bebidas.some(b=>b.n===i.n));
}

function tryFinishOrder(){
  if(hasFood() && !hasDrink()){
    document.getElementById("drinkModal").style.display="flex";
  }else sendOrder();
}

function openDrinks(){
  document.getElementById("drinkModal").style.display="none";
  openTab("bebidas");
}

function skipDrinks(){
  document.getElementById("drinkModal").style.display="none";
  sendOrder();
}

/* ================= WHATSAPP ================= */
function sendOrder(){
  let msg="üçî Pedido Rabika's Burguer\n\n";
  let total=0;

  cart.forEach(i=>{
    msg+=`- ${i.n} x${i.q}\n`;
    total+=i.p*i.q;
  });

  if(isDelivery){
    msg+="Entrega: R$ 8\n";
    total+=FREIGHT;
  }

  msg+=`\nTotal: R$ ${total.toFixed(2).replace('.',',')}`;
  window.open("https://wa.me/554991789706?text="+encodeURIComponent(msg));
}

/* ================= ADMIN VIA BUSCA ================= */
document.getElementById("search").addEventListener("keyup",e=>{
  if(e.key==="Enter" && e.target.value.toLowerCase()===ADMIN_KEY){
    openAdmin();
    e.target.value="";
  }
});
</script>

</body>
</html>
