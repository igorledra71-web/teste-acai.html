<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<title>Rabika's Burguer</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
*{
  box-sizing:border-box;
  margin:0;
  padding:0;
  -webkit-tap-highlight-color: transparent;
}

/* ‚úÖ BODY SEM FLEX (CORRE√á√ÉO DO BOT√ÉO SPLASH) */
body{
  background:linear-gradient(180deg,#06003a 0%,#0a045a 50%,#03001f 100%);
  font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Inter,Arial,sans-serif;
  color:#fff;
  overflow-y:auto;
}

/* ================= SPLASH ================= */
#splashScreen{
  position:fixed;
  inset:0;
  background:linear-gradient(180deg,#06003a,#03001f);
  display:flex;
  justify-content:center;
  align-items:center;
  z-index:9999;
}

.splash-content{
  width:100%;
  height:100%;
  display:flex;
  flex-direction:column;
  justify-content:center;
  align-items:center;
  gap:30px;
}

.splash-logo{
  width:90vw;
  max-width:420px;
}

/* BOT√ÉO PREMIUM */
.splash-btn{
  background:linear-gradient(135deg,#FFD34D,#FFB000);
  border:none;
  padding:18px 46px;
  border-radius:40px;
  font-size:18px;
  font-weight:700;
  letter-spacing:.6px;
  color:#2b0033;
  cursor:pointer;
  box-shadow:0 10px 25px rgba(0,0,0,.35);
  transition:transform .15s ease, box-shadow .15s ease;
  animation:pulse 1.6s infinite;
}
.splash-btn:active{
  transform:scale(.96);
  box-shadow:0 4px 12px rgba(0,0,0,.45) inset;
}

@keyframes pulse{
  0%{transform:scale(1)}
  50%{transform:scale(1.05)}
  100%{transform:scale(1)}
}

/* ================= APP ================= */
#app{
  width:100%;
  max-width:420px;
  margin:0 auto;
  padding:20px 12px 360px;
  display:none;
  flex-direction:column;
  align-items:center;
}

.brand-title{
  font-size:28px;
  font-weight:800;
  letter-spacing:.8px;
  color:#FFD34D;
  margin-bottom:10px;
}

/* ================= BUSCA ================= */
.search-box{width:100%;margin-bottom:15px}
.search-input{
  width:100%;
  padding:14px;
  border-radius:16px;
  border:none;
  font-size:16px;
  font-weight:500;
}
.search-results{
  background:#fff;
  color:#2b0033;
  border-radius:16px;
  margin-top:8px;
  display:none;
}
.search-item{
  padding:12px;
  font-weight:500;
  border-bottom:1px dashed #ccc;
}
.search-item:last-child{border:none}

/* ================= CATEGORIAS ================= */
.category-btn{
  width:100%;
  background:linear-gradient(135deg,#ffcc00,#ff9900);
  color:#2b0033;
  padding:16px;
  border-radius:22px;
  font-weight:800;
  letter-spacing:.6px;
  margin-bottom:14px;
  cursor:pointer;
  text-align:center;
  box-shadow:0 6px 16px rgba(0,0,0,.35);
  transition:transform .12s ease;
}
.category-btn:active{transform:scale(.97)}

.sub-btn{
  width:100%;
  background:#FFD34D;
  color:#2b0033;
  padding:12px;
  border-radius:16px;
  font-weight:700;
  margin:10px 0;
  cursor:pointer;
  text-align:center;
  transition:transform .12s ease;
}
.sub-btn:active{transform:scale(.97)}

.content-box{
  width:100%;
  background:#fff;
  color:#2b0033;
  border-radius:22px;
  padding:15px;
  margin-bottom:20px;
  display:none;
}

/* ================= ITENS ================= */
.item{
  display:grid;
  grid-template-columns:1fr auto auto;
  gap:10px;
  padding:12px 0;
  border-bottom:1px dashed #ddd;
}
.item:last-child{border:none}

.price{
  font-weight:800;
  color:#5a0070;
  font-size:16px;
}

/* BOT√ÉO + */
.btn-add{
  background:#5a0070;
  color:#fff;
  border:none;
  border-radius:10px;
  padding:6px 14px;
  font-size:16px;
  font-weight:700;
  cursor:pointer;
  box-shadow:0 4px 10px rgba(0,0,0,.35);
  transition:transform .12s ease, box-shadow .12s ease;
}
.btn-add:active{
  transform:scale(.92);
  box-shadow:0 2px 6px rgba(0,0,0,.45) inset;
}

/* ================= OFERTA ================= */
.old-price{
  text-decoration:line-through;
  color:#999;
  font-size:13px;
}
.offer-badge{
  background:#e60000;
  color:#fff;
  padding:2px 6px;
  border-radius:6px;
  font-size:11px;
  margin-left:6px;
}
</style>
</head>
<body>

<!-- SPLASH -->
<div id="splashScreen">
  <div class="splash-content">
    <img src="logo.png" class="splash-logo">
    <button type="button" class="splash-btn" onclick="enterApp()">
      FAZER PEDIDO
    </button>
  </div>
</div>

<!-- APP -->
<div id="app">

<div class="brand-title">Rabika's Burguer</div>

<!-- BUSCA -->
<div class="search-box">
  <input class="search-input"
         placeholder="Pesquisar produto..."
         oninput="searchProduct(this.value)">
  <div class="search-results" id="searchResults"></div>
</div>

<!-- LANCHES -->
<div class="category-btn" onclick="toggle('lanches')">üçî Lanches</div>
<div class="content-box" id="lanches">

  <div class="item" data-prod="X-Salada">
    <span>X-Salada</span>
    <span class="price">R$ 17,00</span>
    <button class="btn-add" onclick="addToCart('X-Salada',17)">+</button>
  </div>

  <div class="item" data-prod="X-Burguer">
    <span>X-Burguer</span>
    <span class="price">R$ 14,00</span>
    <button class="btn-add" onclick="addToCart('X-Burguer',14)">+</button>
  </div>

  <div class="item" data-prod="X-Frango">
    <span>X-Frango</span>
    <span class="price">R$ 22,00</span>
    <button class="btn-add" onclick="addToCart('X-Frango',22)">+</button>
  </div>

  <div class="item" data-prod="X-Frango Cremoso">
    <span>X-Frango Cremoso</span>
    <span class="price">R$ 20,00</span>
    <button class="btn-add" onclick="addToCart('X-Frango Cremoso',20)">+</button>
  </div>

  <div class="item" data-prod="X-Bacon">
    <span>X-Bacon</span>
    <span class="price">R$ 25,00</span>
    <button class="btn-add" onclick="addToCart('X-Bacon',25)">+</button>
  </div>

  <div class="item" data-prod="X-Calabresa">
    <span>X-Calabresa</span>
    <span class="price">R$ 25,00</span>
    <button class="btn-add" onclick="addToCart('X-Calabresa',25)">+</button>
  </div>

  <div class="item" data-prod="X-Cora√ß√£o">
    <span>X-Cora√ß√£o</span>
    <span class="price">R$ 27,00</span>
    <button class="btn-add" onclick="addToCart('X-Cora√ß√£o',27)">+</button>
  </div>

  <div class="item" data-prod="X-Tudo">
    <span>X-Tudo</span>
    <span class="price">R$ 32,00</span>
    <button class="btn-add" onclick="addToCart('X-Tudo',32)">+</button>
  </div>

  <div class="item" data-prod="X-Burguer Duplo">
    <span>X-Burguer Duplo</span>
    <span class="price">R$ 22,00</span>
    <button class="btn-add" onclick="addToCart('X-Burguer Duplo',22)">+</button>
  </div>

  <div class="item" data-prod="X-Egg">
    <span>X-Egg</span>
    <span class="price">R$ 20,00</span>
    <button class="btn-add" onclick="addToCart('X-Egg',20)">+</button>
  </div>

  <div class="item" data-prod="X-Tribom">
    <span>X-Tribom</span>
    <span class="price">R$ 32,00</span>
    <button class="btn-add" onclick="addToCart('X-Tribom',32)">+</button>
  </div>

  <div class="item" data-prod="X-Da Casa">
    <span>X-Da Casa</span>
    <span class="price">R$ 45,00</span>
    <button class="btn-add" onclick="addToCart('X-Da Casa',45)">+</button>
  </div>

  <div class="item" data-prod="X-Dog">
    <span>X-Dog</span>
    <span class="price">R$ 20,00</span>
    <button class="btn-add" onclick="addToCart('X-Dog',20)">+</button>
  </div>

  <!-- ADICIONAIS -->
  <div class="sub-btn" onclick="toggle('extrasLanches')">
    ‚ûï Adicionais para Lanches
  </div>

  <div id="extrasLanches" style="display:none;">

    <div class="item" data-prod="Adicional Calabresa">
      <span>Calabresa</span>
      <span class="price">R$ 7,00</span>
      <button class="btn-add" onclick="addToCart('Adicional Calabresa',7)">+</button>
    </div>

    <div class="item" data-prod="Adicional Bacon">
      <span>Bacon</span>
      <span class="price">R$ 7,00</span>
      <button class="btn-add" onclick="addToCart('Adicional Bacon',7)">+</button>
    </div>

    <div class="item" data-prod="Adicional Cora√ß√£o">
      <span>Cora√ß√£o</span>
      <span class="price">R$ 8,00</span>
      <button class="btn-add" onclick="addToCart('Adicional Cora√ß√£o',8)">+</button>
    </div>

    <div class="item" data-prod="Adicional Ovo">
      <span>Ovo</span>
      <span class="price">R$ 3,00</span>
      <button class="btn-add" onclick="addToCart('Adicional Ovo',3)">+</button>
    </div>

    <div class="item" data-prod="Adicional Salsicha">
      <span>Salsicha</span>
      <span class="price">R$ 4,00</span>
      <button class="btn-add" onclick="addToCart('Adicional Salsicha',4)">+</button>
    </div>

    <div class="item" data-prod="Adicional Frango">
      <span>Frango</span>
      <span class="price">R$ 7,00</span>
      <button class="btn-add" onclick="addToCart('Adicional Frango',7)">+</button>
    </div>

    <div class="item" data-prod="Adicional Cheddar">
      <span>Cheddar</span>
      <span class="price">R$ 4,00</span>
      <button class="btn-add" onclick="addToCart('Adicional Cheddar',4)">+</button>
    </div>

    <div class="item" data-prod="Adicional Hamb√∫rguer">
      <span>Hamb√∫rguer artesanal</span>
      <span class="price">R$ 10,00</span>
      <button class="btn-add" onclick="addToCart('Adicional Hamb√∫rguer',10)">+</button>
    </div>

    <div class="item" data-prod="Adicional Maionese">
      <span>Maionese caseira</span>
      <span class="price">R$ 2,00</span>
      <button class="btn-add" onclick="addToCart('Adicional Maionese',2)">+</button>
    </div>

  </div>
</div>
<!-- PAST√âIS -->
<div class="category-btn" onclick="toggle('pasteis')">ü•ü Past√©is</div>
<div class="content-box" id="pasteis">

  <div class="item" data-prod="Pastel de Carne">
    <span>Pastel de Carne</span>
    <span class="price">R$ 14,00</span>
    <button class="btn-add" onclick="addToCart('Pastel de Carne',14)">+</button>
  </div>

  <div class="item" data-prod="Pastel de Frango">
    <span>Pastel de Frango</span>
    <span class="price">R$ 12,00</span>
    <button class="btn-add" onclick="addToCart('Pastel de Frango',12)">+</button>
  </div>

  <div class="item" data-prod="Pastel Frango Bacon Cheddar">
    <span>Frango Bacon Cheddar</span>
    <span class="price">R$ 16,00</span>
    <button class="btn-add" onclick="addToCart('Pastel Frango Bacon Cheddar',16)">+</button>
  </div>

  <div class="item" data-prod="Pastel Bacon Cheddar">
    <span>Bacon Cheddar</span>
    <span class="price">R$ 15,00</span>
    <button class="btn-add" onclick="addToCart('Pastel Bacon Cheddar',15)">+</button>
  </div>

  <div class="item" data-prod="Pastel Calabresa com Cebola">
    <span>Calabresa c/ Cebola</span>
    <span class="price">R$ 14,00</span>
    <button class="btn-add" onclick="addToCart('Pastel Calabresa com Cebola',14)">+</button>
  </div>

  <div class="item" data-prod="Pastel Carne e Queijo">
    <span>Carne e Queijo</span>
    <span class="price">R$ 15,00</span>
    <button class="btn-add" onclick="addToCart('Pastel Carne e Queijo',15)">+</button>
  </div>

  <div class="item" data-prod="Pastel Queijo">
    <span>Queijo</span>
    <span class="price">R$ 14,00</span>
    <button class="btn-add" onclick="addToCart('Pastel Queijo',14)">+</button>
  </div>

  <div class="item" data-prod="Pastel Chocolate ao Leite">
    <span>Chocolate ao Leite</span>
    <span class="price">R$ 15,00</span>
    <button class="btn-add" onclick="addToCart('Pastel Chocolate ao Leite',15)">+</button>
  </div>

  <div class="item" data-prod="Pastel Banana Queijo Canela">
    <span>Banana Queijo Canela</span>
    <span class="price">R$ 15,00</span>
    <button class="btn-add" onclick="addToCart('Pastel Banana Queijo Canela',15)">+</button>
  </div>

  <div class="item" data-prod="Pastel Romeu e Julieta">
    <span>Romeu e Julieta</span>
    <span class="price">R$ 15,00</span>
    <button class="btn-add" onclick="addToCart('Pastel Romeu e Julieta',15)">+</button>
  </div>

  <div class="item" data-prod="Pastel Chocolate Branco">
    <span>Chocolate Branco</span>
    <span class="price">R$ 15,00</span>
    <button class="btn-add" onclick="addToCart('Pastel Chocolate Branco',15)">+</button>
  </div>

  <div class="item" data-prod="Pastel Creme e Ouro Branco">
    <span>Creme e Ouro Branco</span>
    <span class="price">R$ 15,00</span>
    <button class="btn-add" onclick="addToCart('Pastel Creme e Ouro Branco',15)">+</button>
  </div>

  <div class="item" data-prod="Pastel Creme e Sonho de Valsa">
    <span>Creme e Sonho de Valsa</span>
    <span class="price">R$ 15,00</span>
    <button class="btn-add" onclick="addToCart('Pastel Creme e Sonho de Valsa',15)">+</button>
  </div>

</div>

<!-- POR√á√ïES -->
<div class="category-btn" onclick="toggle('porcoes')">üçü Por√ß√µes</div>
<div class="content-box" id="porcoes">

  <div class="item" data-prod="Fritas com Frango">
    <span>Fritas c/ Frango</span>
    <span class="price">R$ 39,99</span>
    <button class="btn-add" onclick="addToCart('Fritas com Frango',39.99)">+</button>
  </div>

  <div class="item" data-prod="Fritas">
    <span>Fritas</span>
    <span class="price">R$ 24,99</span>
    <button class="btn-add" onclick="addToCart('Fritas',24.99)">+</button>
  </div>

  <div class="item" data-prod="Fritas com Calabresa">
    <span>Fritas c/ Calabresa</span>
    <span class="price">R$ 34,99</span>
    <button class="btn-add" onclick="addToCart('Fritas com Calabresa',34.99)">+</button>
  </div>

  <div class="item" data-prod="Fritas com Bacon">
    <span>Fritas c/ Bacon</span>
    <span class="price">R$ 34,99</span>
    <button class="btn-add" onclick="addToCart('Fritas com Bacon',34.99)">+</button>
  </div>

  <div class="item" data-prod="An√©is de Cebola">
    <span>An√©is de Cebola</span>
    <span class="price">R$ 24,99</span>
    <button class="btn-add" onclick="addToCart('An√©is de Cebola',24.99)">+</button>
  </div>

  <div class="item" data-prod="Fritas Bacon Calabresa Queijo">
    <span>Fritas c/ Bacon, Calabresa e Queijo</span>
    <span class="price">R$ 39,99</span>
    <button class="btn-add" onclick="addToCart('Fritas Bacon Calabresa Queijo',39.99)">+</button>
  </div>

  <div class="item" data-prod="Fritas Bacon Cheddar">
    <span>Fritas c/ Bacon Cheddar</span>
    <span class="price">R$ 39,99</span>
    <button class="btn-add" onclick="addToCart('Fritas Bacon Cheddar',39.99)">+</button>
  </div>

  <div class="item" data-prod="Fritas Polenta Frango">
    <span>Fritas c/ Polenta e Frango</span>
    <span class="price">R$ 39,99</span>
    <button class="btn-add" onclick="addToCart('Fritas Polenta Frango',39.99)">+</button>
  </div>

  <div class="item" data-prod="Fritas Polenta">
    <span>Fritas c/ Polenta</span>
    <span class="price">R$ 24,99</span>
    <button class="btn-add" onclick="addToCart('Fritas Polenta',24.99)">+</button>
  </div>

  <div class="item" data-prod="Fritas Calabresa Catupiry">
    <span>Fritas c/ Calabresa e Catupiry</span>
    <span class="price">R$ 35,99</span>
    <button class="btn-add" onclick="addToCart('Fritas Calabresa Catupiry',35.99)">+</button>
  </div>

  <div class="item" data-prod="Por√ß√£o Completa">
    <span>Fritas, Polenta, Chuleta e Anel de Cebola</span>
    <span class="price">R$ 49,99</span>
    <button class="btn-add" onclick="addToCart('Por√ß√£o Completa',49.99)">+</button>
  </div>

</div>

<!-- BEBIDAS -->
<div class="category-btn" onclick="toggle('bebidas')">ü•§ Bebidas</div>
<div class="content-box" id="bebidas">

  <div class="item" data-prod="Cassulinha 200ml">
    <span>Cassulinha 200ml</span>
    <span class="price">R$ 3,00</span>
    <button class="btn-add" onclick="addToCart('Cassulinha 200ml',3)">+</button>
  </div>

  <div class="item" data-prod="Coca-Cola 600ml">
    <span>Coca-Cola 600ml</span>
    <span class="price">R$ 8,00</span>
    <button class="btn-add" onclick="addToCart('Coca-Cola 600ml',8)">+</button>
  </div>

  <div class="item" data-prod="Coca-Cola 2L">
    <span>Coca-Cola 2L</span>
    <span class="price">R$ 16,00</span>
    <button class="btn-add" onclick="addToCart('Coca-Cola 2L',16)">+</button>
  </div>

  <div class="item" data-prod="Refri Lata">
    <span>Refri Lata</span>
    <span class="price">R$ 6,00</span>
    <button class="btn-add" onclick="addToCart('Refri Lata',6)">+</button>
  </div>

  <div class="item" data-prod="Refrigerante 2L">
    <span>Refrigerante 2L</span>
    <span class="price">R$ 12,00</span>
    <button class="btn-add" onclick="addToCart('Refrigerante 2L',12)">+</button>
  </div>

  <div class="item" data-prod="Cerveja Lata 350ml">
    <span>Cerveja Lata 350ml</span>
    <span class="price">R$ 6,00</span>
    <button class="btn-add" onclick="addToCart('Cerveja Lata 350ml',6)">+</button>
  </div>

  <div class="item" data-prod="Achocolatado 200ml">
    <span>Achocolatado 200ml</span>
    <span class="price">R$ 3,00</span>
    <button class="btn-add" onclick="addToCart('Achocolatado 200ml',3)">+</button>
  </div>

</div>

<!-- A√áA√ç -->
<div class="category-btn" onclick="toggle('acai')">üç® A√ßa√≠</div>
<div class="content-box" id="acai">

  <div class="sub-btn" onclick="toggle('acaiTamanhos')">ü•§ Tamanhos</div>
  <div id="acaiTamanhos" style="display:none;">

    <div class="item" data-prod="A√ßa√≠ 300ml">
      <span>300ml</span>
      <span class="price">R$ 12,00</span>
      <button class="btn-add" onclick="addToCart('A√ßa√≠ 300ml',12)">+</button>
    </div>

    <div class="item" data-prod="A√ßa√≠ 400ml">
      <span>400ml</span>
      <span class="price">R$ 15,00</span>
      <button class="btn-add" onclick="addToCart('A√ßa√≠ 400ml',15)">+</button>
    </div>

    <div class="item" data-prod="A√ßa√≠ 500ml">
      <span>500ml</span>
      <span class="price">R$ 18,00</span>
      <button class="btn-add" onclick="addToCart('A√ßa√≠ 500ml',18)">+</button>
    </div>

  </div>

  <div class="sub-btn" onclick="toggle('acaiAdicionais')">üç´ Adicionais</div>
  <div id="acaiAdicionais" style="display:none;">

    <div class="item" data-prod="Pa√ßoca">
      <span>Pa√ßoca</span>
      <span class="price">R$ 2,00</span>
      <button class="btn-add" onclick="addToCart('Pa√ßoca',2)">+</button>
    </div>

    <div class="item" data-prod="Leite em p√≥">
      <span>Leite em p√≥</span>
      <span class="price">R$ 4,00</span>
      <button class="btn-add" onclick="addToCart('Leite em p√≥',4)">+</button>
    </div>

    <div class="item" data-prod="Granola">
      <span>Granola</span>
      <span class="price">R$ 4,00</span>
      <button class="btn-add" onclick="addToCart('Granola',4)">+</button>
    </div>

    <div class="item" data-prod="Morango">
      <span>Morango</span>
      <span class="price">R$ 4,00</span>
      <button class="btn-add" onclick="addToCart('Morango',4)">+</button>
    </div>

    <div class="item" data-prod="M&M">
      <span>M&M</span>
      <span class="price">R$ 3,00</span>
      <button class="btn-add" onclick="addToCart('M&M',3)">+</button>
    </div>

    <div class="item" data-prod="Ouro Branco">
      <span>Ouro Branco</span>
      <span class="price">R$ 3,00</span>
      <button class="btn-add" onclick="addToCart('Ouro Branco',3)">+</button>
    </div>

    <div class="item" data-prod="Banana">
      <span>Banana</span>
      <span class="price">R$ 2,00</span>
      <button class="btn-add" onclick="addToCart('Banana',2)">+</button>
    </div>

    <div class="item" data-prod="Sonho de Valsa">
      <span>Sonho de Valsa</span>
      <span class="price">R$ 3,00</span>
      <button class="btn-add" onclick="addToCart('Sonho de Valsa',3)">+</button>
    </div>

    <div class="item" data-prod="Leite Condensado">
      <span>Leite Condensado</span>
      <span class="price">R$ 3,00</span>
      <button class="btn-add" onclick="addToCart('Leite Condensado',3)">+</button>
    </div>

    <div class="item" data-prod="Nutella">
      <span>Nutella</span>
      <span class="price">R$ 4,00</span>
      <button class="btn-add" onclick="addToCart('Nutella',4)">+</button>
    </div>

  </div>
</div>
</div> <!-- FECHA #app -->

<!-- CARRINHO / PAGAMENTO -->
<div class="cart-footer" id="cartFooter">

  <div id="cartItems"></div>

  <div class="delivery-box" style="display:flex;justify-content:space-around;margin:12px 0;">
    <label>
      <input type="radio" name="entrega" checked onchange="setDelivery(false)">
      Retirada
    </label>
    <label>
      <input type="radio" name="entrega" onchange="setDelivery(true)">
      Entrega (+ R$8)
    </label>
  </div>

  <input class="input-field" id="clientName" placeholder="Seu nome">

  <div id="addressBox" style="display:none;">
    <input class="input-field" id="clientAddress" placeholder="Endere√ßo para entrega">
  </div>

  <select class="select-field" id="paymentMethod" onchange="checkPayment()">
    <option value="">Forma de pagamento</option>
    <option value="Dinheiro">Dinheiro</option>
    <option value="Pix">Pix</option>
    <option value="Cart√£o D√©bito">Cart√£o D√©bito</option>
    <option value="Cart√£o Cr√©dito">Cart√£o Cr√©dito</option>
  </select>

  <div id="trocoBox" style="display:none;margin-top:8px;">
    <div style="display:flex;gap:10px;">
      <button class="btn-add" style="background:#FFD34D;color:#2b0033;flex:1"
        onclick="setTroco(true)">Preciso de troco</button>
      <button class="btn-add" style="background:#ccc;color:#2b0033;flex:1"
        onclick="setTroco(false)">N√£o preciso</button>
    </div>
    <input class="input-field" id="trocoValue"
      placeholder="Troco para quanto? Ex: 50,00" style="display:none;">
  </div>

  <div class="total" id="totalValue">Total: R$ 0,00</div>

  <div class="btn-finish" onclick="finishOrder()">
    Finalizar Pedido
  </div>

</div>

<script>
let cart = [];
let isDelivery = false;
let precisaTroco = false;
let orderHistory = JSON.parse(localStorage.getItem("orderHistory")) || [];

/* ENTRAR NO APP (BOT√ÉO FAZER PEDIDO) */
function enterApp(){
  document.getElementById("splashScreen").style.display = "none";
  document.getElementById("app").style.display = "flex";
}

/* ABRIR / FECHAR CATEGORIAS */
function toggle(id){
  const el = document.getElementById(id);
  el.style.display = el.style.display === "block" ? "none" : "block";
}

/* HOR√ÅRIO */
function isOpenNow(){
  const d = new Date();
  const day = d.getDay();
  const time = d.getHours() + d.getMinutes()/60;
  if(day === 1) return false;
  if(time < 18.5 || time > 22.5) return false;
  return true;
}

/* CARRINHO */
function addToCart(name, price){
  if(!isOpenNow()){
    alert("‚è∞ Estamos fechados.\nAtendimento: Ter√ßa a Domingo das 18:30 √†s 22:30");
    return;
  }
  cart.push({name, price});
  updateCart();
}

function removeItem(i){
  cart.splice(i,1);
  updateCart();
}

function updateCart(){
  const box = document.getElementById("cartItems");
  box.innerHTML = "";
  let total = 0;

  cart.forEach((item,index)=>{
    total += item.price;
    box.innerHTML += `
      <div style="display:grid;grid-template-columns:1fr auto auto;gap:8px;padding:6px 0;">
        <span>${item.name}</span>
        <strong style="color:#5a0070">R$ ${item.price.toFixed(2).replace('.',',')}</strong>
        <button onclick="removeItem(${index})"
          style="background:#e60000;color:#fff;border:none;border-radius:6px;padding:2px 8px">
          ‚úï
        </button>
      </div>`;
  });

  if(isDelivery) total += 8;

  document.getElementById("totalValue").innerText =
    "Total: R$ " + total.toFixed(2).replace('.',',');

  document.getElementById("cartFooter").style.display =
    cart.length ? "block" : "none";
}

/* ENTREGA */
function setDelivery(v){
  isDelivery = v;
  document.getElementById("addressBox").style.display = v ? "block" : "none";
  updateCart();
}

/* PAGAMENTO */
function checkPayment(){
  const payment = document.getElementById("paymentMethod").value;
  const trocoBox = document.getElementById("trocoBox");
  trocoBox.style.display = payment === "Dinheiro" ? "block" : "none";
  document.getElementById("trocoValue").style.display = "none";
  precisaTroco = false;
}

function setTroco(v){
  precisaTroco = v;
  document.getElementById("trocoValue").style.display = v ? "block" : "none";
}

/* FINALIZAR PEDIDO */
function finishOrder(){
  const name = clientName.value;
  const address = clientAddress.value;
  const payment = paymentMethod.value;
  const trocoValor = trocoValue.value;

  if(!name){ alert("Informe seu nome"); return; }
  if(isDelivery && !address){ alert("Informe o endere√ßo"); return; }
  if(!payment){ alert("Informe a forma de pagamento"); return; }

  let msg = "üçî Pedido Rabika's Burguer\n\n";
  msg += "Cliente: " + name + "\n";
  msg += "Pagamento: " + payment + "\n";

  if(payment === "Dinheiro"){
    msg += precisaTroco && trocoValor
      ? "Troco para: R$ " + trocoValor + "\n"
      : "Sem troco\n";
  }

  msg += isDelivery ? "Entrega\nEndere√ßo: "+address+"\n\n" : "Retirada\n\n";
  msg += "Itens:\n";

  let total = 0;
  cart.forEach(i=>{
    msg += "- " + i.name + " R$ " + i.price + "\n";
    total += i.price;
  });

  if(isDelivery){ msg += "Taxa entrega: R$ 8\n"; total += 8; }

  msg += "\nTotal: R$ " + total.toFixed(2).replace('.',',');

  orderHistory.push({
    datetime:new Date().toISOString(),
    total, payment, delivery:isDelivery
  });
  localStorage.setItem("orderHistory", JSON.stringify(orderHistory));

  window.open("https://wa.me/554991789706?text="+encodeURIComponent(msg));
}
</script>
<!-- PAINEL ADMINISTRATIVO -->
<div id="adminScreen">
  <div class="admin-header">
    <span>üî• Painel de Ofertas</span>
    <button onclick="closeAdmin()"
      style="background:none;border:none;font-size:18px;font-weight:bold;cursor:pointer">
      ‚úï
    </button>
  </div>

  <div class="admin-content">

    <div class="admin-card">
      <h3 style="margin-bottom:10px">Criar / Atualizar Oferta</h3>

      <select class="admin-select" id="offerProduct">
        <option value="">Selecionar produto</option>
      </select>

      <input class="admin-input" id="offerPrice" type="number" step="0.01"
        placeholder="Pre√ßo promocional fixo">

      <label>In√≠cio da oferta</label>
      <input class="admin-input" id="offerStart" type="datetime-local">

      <label>Fim da oferta</label>
      <input class="admin-input" id="offerEnd" type="datetime-local">

      <button class="admin-btn" onclick="saveOffer()">Salvar / Ativar Oferta</button>

      <button class="admin-btn"
        style="background:#ccc;color:#2b0033;margin-top:8px"
        onclick="disableOffer()">
        Desativar Oferta
      </button>
    </div>

    <div class="admin-card">
      <h3>Status das Ofertas</h3>
      <div id="offerStatus">Nenhuma oferta ativa</div>
    </div>

  </div>
</div>

<script>
/* ==========================
   SISTEMA ADMINISTRATIVO
========================== */

const ADMIN_PASSWORD = "adm123";
let offers = JSON.parse(localStorage.getItem("offers")) || {};

/* INTERCEPTA BUSCA "oferta" */
const originalSearchProduct = searchProduct;
searchProduct = function(q){
  if(q.toLowerCase() === "oferta"){
    const senha = prompt("üîê Acesso Administrativo");
    if(senha === ADMIN_PASSWORD){
      openAdmin();
    }else{
      alert("‚ùå Senha incorreta");
    }
    return;
  }
  originalSearchProduct(q);
};

/* ABRIR / FECHAR PAINEL */
function openAdmin(){
  const scr = document.getElementById("adminScreen");
  scr.style.display = "flex";
  loadAdminProducts();
  updateAdminStatus();
}

function closeAdmin(){
  document.getElementById("adminScreen").style.display = "none";
}

/* LISTAR PRODUTOS */
function loadAdminProducts(){
  const select = document.getElementById("offerProduct");
  select.innerHTML = '<option value="">Selecionar produto</option>';

  document.querySelectorAll(".item[data-prod]").forEach(el=>{
    const name = el.getAttribute("data-prod");
    select.innerHTML += `<option value="${name}">${name}</option>`;
  });
}

/* SALVAR / ATIVAR OFERTA */
function saveOffer(){
  const prod = offerProduct.value;
  const price = parseFloat(offerPrice.value);
  const start = offerStart.value;
  const end = offerEnd.value;

  if(!prod || !price || !start || !end){
    alert("Preencha todos os campos");
    return;
  }

  offers[prod] = {
    price,
    start: new Date(start).getTime(),
    end: new Date(end).getTime(),
    active: true
  };

  localStorage.setItem("offers", JSON.stringify(offers));
  applyOffers();
  updateAdminStatus();
  alert("‚úÖ Oferta ativada");
}

/* DESATIVAR OFERTA */
function disableOffer(){
  const prod = offerProduct.value;
  if(!prod || !offers[prod]){
    alert("Selecione uma oferta ativa");
    return;
  }

  delete offers[prod];
  localStorage.setItem("offers", JSON.stringify(offers));
  applyOffers();
  updateAdminStatus();
}

/* APLICAR OFERTAS */
function applyOffers(){
  const now = Date.now();

  document.querySelectorAll(".item[data-prod]").forEach(el=>{
    const prod = el.getAttribute("data-prod");
    const priceEl = el.querySelector(".price");

    if(offers[prod] && now >= offers[prod].start && now <= offers[prod].end){
      if(!priceEl.dataset.original){
        priceEl.dataset.original = priceEl.innerText;
      }
      priceEl.innerHTML = `
        <span class="old-price">${priceEl.dataset.original}</span>
        <strong style="color:#e60000;font-size:16px">
          R$ ${offers[prod].price.toFixed(2).replace('.',',')}
        </strong>
        <span class="offer-badge">OFERTA</span>
      `;
    }else{
      if(priceEl.dataset.original){
        priceEl.innerText = priceEl.dataset.original;
        delete priceEl.dataset.original;
      }
    }
  });
}

/* STATUS */
function updateAdminStatus(){
  const box = document.getElementById("offerStatus");
  let html = "";
  const now = Date.now();

  Object.keys(offers).forEach(p=>{
    const o = offers[p];
    if(now <= o.end){
      html += `‚úî ${p} ‚Üí R$ ${o.price.toFixed(2).replace('.',',')}<br>`;
    }
  });

  box.innerHTML = html || "Nenhuma oferta ativa";
}

/* AUTO */
applyOffers();
setInterval(applyOffers, 60000);
</script>

</body>
</html>
