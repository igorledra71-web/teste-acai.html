<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<title>Rabika's Burguer</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700;800;900&display=swap" rel="stylesheet">

<!-- FIREBASE -->
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>

<script>
firebase.initializeApp({
  apiKey: "AIzaSyCYi1rHHuUPV1QB64N9ciBXNvER3caUc0k",
  authDomain: "rabikas-burguer.firebaseapp.com",
  databaseURL: "https://rabikas-burguer-default-rtdb.firebaseio.com",
  projectId: "rabikas-burguer",
  storageBucket: "rabikas-burguer.appspot.com",
  messagingSenderId: "922454808804",
  appId: "1:922454808804:web:d0aa9ae5fc78b8d10674f1"
});
const db = firebase.database();
</script>

<style>
*{box-sizing:border-box;margin:0;padding:0}
body{
  font-family:'Poppins',sans-serif;
  background:linear-gradient(180deg,#06003a,#0a045a,#03001f);
  color:#fff;
  display:flex;
  justify-content:center;
}

/* APP */
#app{max-width:420px;width:100%;padding:14px 14px 280px;display:none}

/* SPLASH */
#splash{
  position:fixed;inset:0;
  display:flex;align-items:center;justify-content:center;
  background:#05002e;z-index:9999
}
.splash-logo{max-width:320px;width:90%;margin-bottom:30px}
.splash-btn{padding:18px 50px;border:none;border-radius:40px;background:#FFD34D;font-weight:900;font-size:22px}

/* TOPO */
.title{text-align:center;font-size:30px;font-weight:900;color:#FFD34D}

/* BUSCA */
.search{width:100%;padding:14px;border-radius:22px;border:none;margin:14px 0}

/* TABS */
.tabs{display:grid;grid-template-columns:repeat(5,1fr);gap:8px}
.tab{background:#fff;color:#2b0033;border-radius:18px;padding:10px;font-weight:800;text-align:center}
.tab.active{background:#FFD34D}

/* BOX */
.box{background:#fff;color:#2b0033;border-radius:28px;padding:18px;margin-top:14px;display:none}
.box.active{display:block}

/* ITEM */
.item{display:grid;grid-template-columns:1fr auto auto;gap:10px;padding:12px 0;border-bottom:1px dashed #ccc}
.btn-add{background:#5a0070;color:#fff;border:none;border-radius:14px;padding:6px 14px;font-weight:900}

/* OFERTA */
.item.offer{background:#fff6d8;border-radius:14px;padding:12px}
.old-price{text-decoration:line-through;font-size:12px;color:#999}
.offer-price{font-weight:900;color:#b00020}
.offer-badge{background:#b00020;color:#fff;font-size:11px;padding:2px 8px;border-radius:12px;margin-left:6px}

/* CARRINHO */
#cart{
  position:fixed;bottom:0;left:50%;transform:translateX(-50%);
  max-width:420px;width:100%;
  background:#fff;color:#2b0033;
  padding:18px;border-radius:28px 28px 0 0;
  display:none
}

/* MODAL ‚Äî CORRE√á√ÉO AQUI */
.modal{
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.6);
  display:flex;
  align-items:center;
  justify-content:center;
  z-index:10000;
  overflow-y:auto; /* ‚úÖ */
}
.modal-box{
  background:#fff;color:#2b0033;
  border-radius:26px;
  padding:20px;
  width:90%;max-width:420px;
  max-height:85vh;      /* ‚úÖ */
  overflow-y:auto;      /* ‚úÖ */
}

/* BOT√ÉO */
.btn-green{background:#25D366;color:#fff;border:none;padding:14px;border-radius:22px;font-weight:900;width:100%}
</style>
</head>
<body>

<!-- ================= SPLASH ================= -->
<div id="splash">
  <div style="text-align:center">
    <img src="logo.png" class="splash-logo" alt="Rabika's Burguer">
    <button class="splash-btn" id="startBtn">FAZER PEDIDO</button>
  </div>
</div>

<!-- ================= APP ================= -->
<div id="app">

  <div class="title">Rabika's Burguer</div>
  <div style="text-align:center;font-size:13px;margin-top:6px">
    üïí Ter√ßa a Domingo ‚Äî 18:30 √†s 22:30
  </div>

  <!-- BUSCA -->
  <input
    id="search"
    class="search"
    placeholder="Pesquisar no card√°pio ou digitar: admin | oferta | relatorio"
  >

  <!-- ================= ABAS ================= -->
  <div class="tabs">
    <div class="tab" onclick="openTab('lanches',this)">üçî Lanches</div>
    <div class="tab" onclick="openTab('porcoes',this)">üçü Por√ß√µes</div>
    <div class="tab" onclick="openTab('pasteis',this)">ü•ü Past√©is</div>
    <div class="tab" onclick="openTab('acai',this)">üç® A√ßa√≠</div>
    <div class="tab" onclick="openTab('bebidas',this)">ü•§ Bebidas</div>
  </div>

  <!-- ================= CONTE√öDO ================= -->
  <div id="lanches" class="box"></div>
  <div id="porcoes" class="box"></div>
  <div id="pasteis" class="box"></div>
  <div id="acai" class="box"></div>
  <div id="bebidas" class="box"></div>

</div>
<script>
/* ================= CONFIGURA√á√ïES ================= */
const FREIGHT = 8;
const ADMIN_PASSWORD = "1234";

/* ================= ESTADO GLOBAL ================= */
let cart = [];
let currentTab = null;

/* ================= ESTADOS VINDOS DO FIREBASE ================= */
let customPrices = {};
let productStatus = {};
let offers = {};
let sales = {};

/* ================= FIREBASE LISTENERS ================= */
db.ref("prices").on("value", snap => {
  customPrices = snap.val() || {};
  renderAll();
});

db.ref("productStatus").on("value", snap => {
  productStatus = snap.val() || {};
  renderAll();
});

db.ref("offers").on("value", snap => {
  offers = snap.val() || {};
  renderAll();
});

db.ref("sales").on("value", snap => {
  sales = snap.val() || {};
});

/* ================= SAFE ID ================= */
function safeId(name){
  return name.toLowerCase()
    .normalize("NFD").replace(/[\u0300-\u036f]/g,"")
    .replace(/[^a-z0-9]+/g,"_");
}

/* ================= HOR√ÅRIO ================= */
function isOpen(){
  const d = new Date();
  const day = d.getDay();
  const h = d.getHours() + d.getMinutes()/60;
  if(day === 1) return false;
  if(h < 18.5 || h > 22.5) return false;
  return true;
}

/* ================= PRODUTOS BASE ================= */
const products = {
  lanches:[
    {n:"X-Salada",p:17},{n:"X-Burguer",p:14},{n:"X-Frango",p:22},
    {n:"X-Frango Cremoso",p:20},{n:"X-Bacon",p:25},{n:"X-Calabresa",p:25},
    {n:"X-Cora√ß√£o",p:27},{n:"X-Tudo",p:32},{n:"X-Burguer Duplo",p:22},
    {n:"X-Egg",p:20},{n:"X-Tribom",p:32},{n:"X-Da Casa",p:45},{n:"X-Dog",p:20}
  ],
  adicionaisLanches:[
    {n:"Calabresa",p:7},{n:"Bacon",p:7},{n:"Cora√ß√£o",p:8},
    {n:"Ovo",p:3},{n:"Salsicha",p:4},{n:"Frango",p:7},
    {n:"Cheddar",p:4},{n:"Hamb√∫rguer artesanal",p:10},{n:"Maionese caseira",p:2}
  ],
  porcoes:[
    {n:"Fritas",p:24.99},{n:"Fritas c/ Frango",p:39.99},
    {n:"Fritas c/ Calabresa",p:34.99},{n:"Fritas c/ Bacon",p:34.99},
    {n:"An√©is de Cebola",p:24.99},
    {n:"Fritas c/ Bacon, Calabresa e Queijo",p:39.99},
    {n:"Fritas c/ Bacon Cheddar",p:39.99},
    {n:"Fritas c/ Polenta e Frango",p:39.99},
    {n:"Fritas c/ Polenta",p:24.99},
    {n:"Fritas c/ Calabresa e Catupiry",p:35.99},
    {n:"Fritas, Polenta, Chuleta e Anel de Cebola",p:49.99}
  ],
  pasteis:[
    {n:"Pastel de Carne",p:14},{n:"Pastel de Frango",p:12},
    {n:"Frango Bacon Cheddar",p:16},{n:"Bacon Cheddar",p:15},
    {n:"Calabresa c/ Cebola",p:14},{n:"Carne e Queijo",p:15},
    {n:"Queijo",p:14},{n:"Chocolate ao Leite",p:15},
    {n:"Banana Queijo Canela",p:15},{n:"Romeu e Julieta",p:15},
    {n:"Chocolate Branco",p:15},{n:"Creme e Ouro Branco",p:15},
    {n:"Creme e Sonho de Valsa",p:15}
  ],
  acaiTamanhos:[
    {n:"A√ßa√≠ 300ml",p:12},{n:"A√ßa√≠ 400ml",p:15},{n:"A√ßa√≠ 500ml",p:18}
  ],
  acaiAdicionais:[
    {n:"Pa√ßoca",p:2},{n:"Leite em p√≥",p:4},{n:"Granola",p:4},
    {n:"Morango",p:4},{n:"M&M",p:3},{n:"Ouro Branco",p:3},
    {n:"Banana",p:2},{n:"Sonho de Valsa",p:3},
    {n:"Leite Condensado",p:3},{n:"Nutella",p:4}
  ],
  bebidas:[
    {n:"Cassulinha 200ml",p:3},{n:"Coca-Cola 600ml",p:8},
    {n:"Coca-Cola 2L",p:16},{n:"Refri Lata",p:6},
    {n:"Refrigerante 2L",p:12},{n:"Cerveja Lata 350ml",p:6},
    {n:"Achocolatado 200ml",p:3}
  ]
};
</script>
<script>
/* ================= PRE√áO FINAL ================= */
function getFinalPrice(p){
  const sid = safeId(p.n);
  const today = new Date().toISOString().split("T")[0];

  if(offers[sid] && today >= offers[sid].start && today <= offers[sid].end){
    return Number(offers[sid].price);
  }
  if(customPrices[sid] != null){
    return Number(customPrices[sid]);
  }
  return Number(p.p);
}

/* ================= RENDER GERAL ================= */
function renderAll(){
  renderCategory("lanches", products.lanches, products.adicionaisLanches);
  renderCategory("porcoes", products.porcoes);
  renderCategory("pasteis", products.pasteis);
  renderAcai();
  renderCategory("bebidas", products.bebidas);
}

/* ================= RENDER CATEGORIA ================= */
function renderCategory(id, list, extras){
  const box = document.getElementById(id);
  if(!box) return;
  box.innerHTML = "";

  list.forEach(p=>{
    const sid = safeId(p.n);
    if(productStatus[sid] === false) return;
    box.innerHTML += itemHTML(p);
  });

  if(extras){
    box.innerHTML += `<div style="font-weight:900;margin:12px 0">‚ûï Adicionais</div>`;
    extras.forEach(p=>{
      const sid = safeId(p.n);
      if(productStatus[sid] !== false){
        box.innerHTML += itemHTML(p);
      }
    });
  }
}

/* ================= RENDER A√áA√ç ================= */
function renderAcai(){
  const box = document.getElementById("acai");
  if(!box) return;

  box.innerHTML = `<div style="font-weight:900;margin-bottom:8px">ü•§ Tamanhos</div>`;
  products.acaiTamanhos.forEach(p=>{
    if(productStatus[safeId(p.n)] !== false){
      box.innerHTML += itemHTML(p);
    }
  });

  box.innerHTML += `<div style="font-weight:900;margin:12px 0 8px">üç´ Adicionais</div>`;
  products.acaiAdicionais.forEach(p=>{
    if(productStatus[safeId(p.n)] !== false){
      box.innerHTML += itemHTML(p);
    }
  });
}

/* ================= ITEM ================= */
function itemHTML(p){
  const sid = safeId(p.n);
  const base = Number(p.p);
  const price = getFinalPrice(p);
  const today = new Date().toISOString().split("T")[0];
  const hasOffer = offers[sid] && today >= offers[sid].start && today <= offers[sid].end;

  if(hasOffer){
    return `
      <div class="item offer" data-name="${p.n.toLowerCase()}">
        <div>
          <strong>${p.n}</strong>
          <span class="offer-badge">OFERTA</span>
          <div class="old-price">De R$ ${base.toFixed(2).replace(".",",")}</div>
          <div class="offer-price">Por R$ ${price.toFixed(2).replace(".",",")}</div>
        </div>
        <span></span>
        <button class="btn-add" onclick="addItem('${p.n}',${price})">+</button>
      </div>
    `;
  }

  return `
    <div class="item" data-name="${p.n.toLowerCase()}">
      <span>${p.n}</span>
      <span>R$ ${price.toFixed(2).replace(".",",")}</span>
      <button class="btn-add" onclick="addItem('${p.n}',${price})">+</button>
    </div>
  `;
}

/* ================= ABAS ================= */
function openTab(id, el){
  const box = document.getElementById(id);
  if(!box) return;

  const active = box.classList.contains("active");

  document.querySelectorAll(".box").forEach(b=>b.classList.remove("active"));
  document.querySelectorAll(".tab").forEach(t=>t.classList.remove("active"));

  if(!active){
    box.classList.add("active");
    if(el) el.classList.add("active");
    currentTab = id;
  }else{
    currentTab = null;
  }
}

/* ================= BUSCA GLOBAL ================= */
document.getElementById("search").addEventListener("input", function(){
  const v = this.value.toLowerCase().trim();
  let foundTab = null;

  document.querySelectorAll(".item").forEach(i=>{
    const ok = i.dataset.name.includes(v);
    i.style.display = ok ? "grid" : "none";
    if(ok && !foundTab){
      const parent = i.closest(".box");
      if(parent) foundTab = parent.id;
    }
  });

  if(foundTab){
    const tab = [...document.querySelectorAll(".tab")]
      .find(t=>t.getAttribute("onclick").includes(foundTab));
    if(tab) openTab(foundTab, tab);
  }

  if(!v){
    document.querySelectorAll(".item").forEach(i=>i.style.display="grid");
  }
}

/* ================= START ================= */
document.getElementById("startBtn").onclick = ()=>{
  document.getElementById("splash").style.display = "none";
  document.getElementById("app").style.display = "block";
  renderAll();
};
</script>
<script>
/* ================= CARRINHO ================= */
function addItem(name, price){
  if(!isOpen()){
    alert("Estamos fechados no momento.\nTer√ßa a Domingo ‚Äî 18:30 √†s 22:30");
    return;
  }
  cart.push({ name, price });
  updateCart();
}

function removeItem(index){
  cart.splice(index, 1);
  updateCart();
}

function updateCart(){
  let cartBox = document.getElementById("cart");
  if(!cartBox){
    document.body.insertAdjacentHTML("beforeend", `
      <div id="cart">
        <div id="cartItems"></div>

        <div style="margin-top:10px">
          <label>
            <input type="radio" name="delivery" onclick="setDelivery(false)" checked>
            Retirada
          </label>
          &nbsp;&nbsp;
          <label>
            <input type="radio" name="delivery" onclick="setDelivery(true)">
            Entrega
          </label>
        </div>

        <input id="customerName" class="search" placeholder="Seu nome">
        <input id="address" class="search" placeholder="Endere√ßo para entrega" style="display:none">

        <select id="payment" class="search">
          <option value="">Forma de pagamento</option>
          <option value="Dinheiro">Dinheiro</option>
          <option value="Pix">Pix</option>
          <option value="D√©bito">Cart√£o D√©bito</option>
          <option value="Cr√©dito">Cart√£o Cr√©dito</option>
        </select>

        <div id="total" style="font-weight:900;margin-top:8px"></div>

        <button class="btn-green" onclick="finishOrder()">Finalizar Pedido</button>
      </div>
    `);
    cartBox = document.getElementById("cart");
  }

  const items = document.getElementById("cartItems");
  items.innerHTML = "";

  let total = 0;
  cart.forEach((i, idx)=>{
    total += i.price;
    items.innerHTML += `
      <div style="display:flex;justify-content:space-between;margin-bottom:6px">
        <span>${i.name}</span>
        <span>
          R$ ${i.price.toFixed(2).replace(".",",")}
          <button onclick="removeItem(${idx})">‚úï</button>
        </span>
      </div>
    `;
  });

  if(isDelivery) total += FREIGHT;

  document.getElementById("total").innerText =
    "Total: R$ " + total.toFixed(2).replace(".",",");

  cartBox.style.display = cart.length ? "block" : "none";
}

/* ================= ENTREGA ================= */
let isDelivery = false;

function setDelivery(v){
  isDelivery = v;
  document.getElementById("address").style.display = v ? "block" : "none";
  updateCart();
}

/* ================= BEBIDA ================= */
function finishOrder(){
  const hasDrink = cart.some(i =>
    products.bebidas.some(b => b.n === i.name)
  );

  if(!hasDrink){
    if(confirm("Voc√™ vai querer bebida?")){
      openTab("bebidas");
      return;
    }
  }
  sendOrder();
}

/* ================= WHATSAPP ================= */
function sendOrder(){
  const name = document.getElementById("customerName").value.trim();
  if(!name){
    alert("Informe seu nome");
    return;
  }

  let msg = `üçî Pedido Rabika's Burguer\n\nCliente: ${name}\n\n`;
  let total = 0;

  cart.forEach(i=>{
    msg += `- ${i.name} R$ ${i.price.toFixed(2).replace(".",",")}\n`;
    total += i.price;
  });

  if(isDelivery){
    const addr = document.getElementById("address").value.trim();
    if(!addr){
      alert("Informe o endere√ßo");
      return;
    }
    msg += `\nEntrega: R$ ${FREIGHT.toFixed(2).replace(".",",")}\n`;
    msg += `Endere√ßo: ${addr}\n`;
    total += FREIGHT;
  }else{
    msg += "\nRetirada no local\n";
  }

  const payment = document.getElementById("payment").value || "N√£o informado";
  msg += `Pagamento: ${payment}\n`;
  msg += `\nTotal: R$ ${total.toFixed(2).replace(".",",")}`;

  db.ref("sales/" + Date.now()).set({
    date: new Date().toISOString(),
    total,
    payment
  });

  window.open(
    "https://wa.me/554991789706?text=" + encodeURIComponent(msg),
    "_blank"
  );

  cart = [];
  updateCart();
}
</script>
<script>
/* ================= SCROLL LOCK ================= */
function lockScroll(){
  document.body.style.overflow = "hidden";
}
function unlockScroll(){
  document.body.style.overflow = "";
}

/* ================= ADMIN ‚Äî ABERTURA ================= */
function openAdmin(){
  if(document.getElementById("adminModal")) return;
  lockScroll();

  document.body.insertAdjacentHTML("beforeend", `
    <div class="modal" id="adminModal">
      <div class="modal-box">
        <div style="text-align:right;font-weight:900;cursor:pointer" onclick="closeAdmin()">‚úï</div>
        <h2 style="text-align:center;color:#5a0070">Painel Administrativo</h2>
        <p style="text-align:center;font-size:13px;margin-bottom:12px">
          Alterar pre√ßos e ocultar produtos
        </p>
        <div id="adminProducts"></div>
      </div>
    </div>
  `);

  renderAdminProducts();
}

function closeAdmin(){
  const m = document.getElementById("adminModal");
  if(m) m.remove();
  unlockScroll();
}

/* ================= RENDER ADMIN ================= */
function renderAdminProducts(){
  const box = document.getElementById("adminProducts");
  if(!box) return;

  box.innerHTML = "";

  Object.keys(products).forEach(cat=>{
    box.innerHTML += `
      <h3 style="margin:14px 0 6px;color:#5a0070">
        ${cat.toUpperCase()}
      </h3>
    `;

    products[cat].forEach(p=>{
      const sid = safeId(p.n);
      const price = customPrices[sid] ?? p.p;
      const hidden = productStatus[sid] === false;

      box.innerHTML += `
        <div style="border-bottom:1px dashed #ddd;padding:10px 0">
          <strong>${p.n}</strong>

          <input
            type="number"
            value="${price}"
            style="width:100%;padding:8px;margin-top:6px;border-radius:12px;border:1px solid #ccc"
            onchange="saveAdminPrice('${sid}', this.value)"
          >

          <button
            class="btn-green"
            style="margin-top:6px;background:${hidden ? '#999' : '#25D366'}"
            onclick="toggleProduct('${sid}')"
          >
            ${hidden ? "REATIVAR" : "OCULTAR"}
          </button>
        </div>
      `;
    });
  });
}

/* ================= SALVAR PRE√áO ================= */
function saveAdminPrice(sid, value){
  const price = Number(value);
  if(isNaN(price)) return;
  customPrices[sid] = price;
  db.ref("prices").set(customPrices);
}

/* ================= OCULTAR / REATIVAR ================= */
function toggleProduct(sid){
  productStatus[sid] = productStatus[sid] === false ? true : false;
  db.ref("productStatus").set(productStatus);
}
</script>
<script>
/* ================= ADMIN ‚Äî OFERTAS ================= */
function openOffer(){
  if(document.getElementById("offerModal")) return;
  lockScroll();

  document.body.insertAdjacentHTML("beforeend", `
    <div class="modal" id="offerModal">
      <div class="modal-box">
        <div style="text-align:right;font-weight:900;cursor:pointer" onclick="closeOffer()">‚úï</div>
        <h2 style="text-align:center;color:#b00020">Painel de Ofertas</h2>
        <p style="text-align:center;font-size:13px;margin-bottom:12px">
          Defina pre√ßo promocional e per√≠odo da oferta
        </p>
        <div id="offerProducts"></div>
      </div>
    </div>
  `);

  renderOfferProducts();
}

function closeOffer(){
  const m = document.getElementById("offerModal");
  if(m) m.remove();
  unlockScroll();
}

/* ================= RENDER OFERTAS ================= */
function renderOfferProducts(){
  const box = document.getElementById("offerProducts");
  if(!box) return;

  box.innerHTML = "";
  const today = new Date().toISOString().split("T")[0];

  Object.keys(products).forEach(cat=>{
    box.innerHTML += `
      <h3 style="margin:14px 0 6px;color:#b00020">
        ${cat.toUpperCase()}
      </h3>
    `;

    products[cat].forEach(p=>{
      const sid = safeId(p.n);
      const offer = offers[sid] || {};

      box.innerHTML += `
        <div style="
          border:2px solid #b00020;
          border-radius:18px;
          padding:14px;
          margin-bottom:12px;
          background:#fff3f3
        ">
          <strong>${p.n}</strong>

          <label style="font-size:12px;display:block;margin-top:8px">
            Pre√ßo de oferta
          </label>
          <input
            type="number"
            value="${offer.price ?? ""}"
            style="width:100%;padding:10px;border-radius:14px;border:2px solid #b00020"
            onchange="updateOffer('${sid}','price',this.value)"
          >

          <label style="font-size:12px;display:block;margin-top:8px">
            Data in√≠cio
          </label>
          <input
            type="date"
            value="${offer.start ?? ""}"
            style="width:100%;padding:10px;border-radius:14px;border:1px solid #ccc"
            onchange="updateOffer('${sid}','start',this.value)"
          >

          <label style="font-size:12px;display:block;margin-top:8px">
            Data fim
          </label>
          <input
            type="date"
            value="${offer.end ?? ""}"
            style="width:100%;padding:10px;border-radius:14px;border:1px solid #ccc"
            onchange="updateOffer('${sid}','end',this.value)"
          >

          <button
            class="btn-green"
            style="margin-top:12px;background:#b00020"
            onclick="saveOffer('${sid}')"
          >
            üíæ Salvar Oferta
          </button>

          ${
            offer.start && offer.end &&
            today >= offer.start && today <= offer.end
              ? `<div style="margin-top:8px;color:#b00020;font-weight:900">
                  üî• Oferta ativa
                </div>`
              : ""
          }
        </div>
      `;
    });
  });
}

/* ================= ATUALIZAR CAMPO ================= */
function updateOffer(sid, field, value){
  if(!offers[sid]) offers[sid] = {};
  offers[sid][field] = value;
}

/* ================= SALVAR OFERTA ================= */
function saveOffer(sid){
  if(!offers[sid] || !offers[sid].price || !offers[sid].start || !offers[sid].end){
    alert("Preencha pre√ßo, data in√≠cio e data fim");
    return;
  }
  db.ref("offers").set(offers);
}
</script>
<script>
/* ================= BUSCA ‚Äî ATALHOS ADMIN ================= */
document.getElementById("search").addEventListener("keydown", function(e){
  if(e.key !== "Enter") return;

  const v = this.value.toLowerCase().trim();
  const adminKeys = ["admin","pre√ßo","precos"];
  const offerKeys = ["oferta","ofertas"];
  const reportKeys = ["relatorio","relat√≥rio"];

  if(
    !adminKeys.includes(v) &&
    !offerKeys.includes(v) &&
    !reportKeys.includes(v)
  ) return;

  e.preventDefault();

  const senha = prompt("Senha do administrador:");
  if(senha !== ADMIN_PASSWORD){
    this.value = "";
    alert("Senha incorreta");
    return;
  }

  if(adminKeys.includes(v)) openAdmin();
  if(offerKeys.includes(v)) openOffer();
  if(reportKeys.includes(v)) openReport();

  this.value = "";
});

/* ================= ADMIN ‚Äî RELAT√ìRIO ================= */
function openReport(){
  if(document.getElementById("reportModal")) return;
  lockScroll();

  document.body.insertAdjacentHTML("beforeend", `
    <div class="modal" id="reportModal">
      <div class="modal-box">
        <div style="text-align:right;font-weight:900;cursor:pointer" onclick="closeReport()">‚úï</div>
        <h2 style="text-align:center;color:#5a0070">Relat√≥rio de Vendas</h2>
        <div id="reportContent" style="margin-top:14px"></div>
      </div>
    </div>
  `);

  renderReport();
}

function closeReport(){
  const m = document.getElementById("reportModal");
  if(m) m.remove();
  unlockScroll();
}

/* ================= RENDER RELAT√ìRIO ================= */
function renderReport(){
  const box = document.getElementById("reportContent");
  if(!box) return;

  let total = 0;
  let dinheiro = 0;
  let pix = 0;
  let debito = 0;
  let credito = 0;

  Object.values(sales || {}).forEach(s=>{
    total += s.total || 0;
    const p = (s.payment || "").toLowerCase();
    if(p.includes("dinheiro")) dinheiro += s.total || 0;
    else if(p.includes("pix")) pix += s.total || 0;
    else if(p.includes("debito")) debito += s.total || 0;
    else if(p.includes("credito")) credito += s.total || 0;
  });

  box.innerHTML = `
    <div style="font-weight:900;margin-bottom:10px">
      Total vendido: R$ ${total.toFixed(2).replace(".",",")}
    </div>
    <div>üíµ Dinheiro: R$ ${dinheiro.toFixed(2).replace(".",",")}</div>
    <div>‚ö° Pix: R$ ${pix.toFixed(2).replace(".",",")}</div>
    <div>üí≥ D√©bito: R$ ${debito.toFixed(2).replace(".",",")}</div>
    <div>üí≥ Cr√©dito: R$ ${credito.toFixed(2).replace(".",",")}</div>
  `;
}
</script>

</body>
</html>
