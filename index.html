<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<title>Rabika's Burguer</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700;800;900&display=swap" rel="stylesheet">

<style>
*{box-sizing:border-box;margin:0;padding:0}
html,body{height:100%}
body{
  font-family:'Poppins',sans-serif;
  background:linear-gradient(180deg,#06003a,#0a045a,#03001f);
  color:#fff;
  display:flex;
  justify-content:center;
}

/* APP */
#app{
  width:100%;
  max-width:420px;
  padding:14px 14px 320px;
  display:none;
}

/* SPLASH */
#splash{
  position:fixed;
  inset:0;
  background:linear-gradient(180deg,#05002e,#020018);
  display:flex;
  align-items:center;
  justify-content:center;
  z-index:9999;
}
.splash-box{text-align:center}
.splash-logo{
  width:90%;
  max-width:340px;
  margin-bottom:32px;
}
.splash-btn{
  background:linear-gradient(135deg,#FFD34D,#FFB000);
  border:none;
  padding:18px 54px;
  border-radius:44px;
  font-size:22px;
  font-weight:900;
  color:#2b0033;
  cursor:pointer;
}

/* TOPO */
.title{
  text-align:center;
  font-size:30px;
  font-weight:900;
  color:#FFD34D;
  margin-bottom:8px;
}

/* FECHADO */
#closedBanner{
  background:#b00020;
  color:#fff;
  text-align:center;
  padding:12px;
  border-radius:18px;
  font-size:13px;
  font-weight:600;
  margin-bottom:10px;
}

/* BUSCA */
.search{
  width:100%;
  padding:14px 16px;
  border-radius:22px;
  border:none;
  font-size:15px;
  margin-bottom:14px;
}

/* TABS */
.tabs{
  display:grid;
  grid-template-columns:repeat(5,1fr);
  gap:10px;
  margin-bottom:14px;
}
.tab{
  background:#fff;
  color:#2b0033;
  padding:14px;
  border-radius:22px;
  font-weight:800;
  text-align:center;
  cursor:pointer;
}
.tab.active{
  background:#FFD34D;
}

/* CONTE√öDO */
.box{
  background:#fff;
  color:#2b0033;
  border-radius:28px;
  padding:18px;
  margin-bottom:20px;
  display:none;
}
.box.active{display:block}

/* ITEM */
.item{
  display:grid;
  grid-template-columns:1fr auto auto;
  gap:10px;
  padding:12px 0;
  border-bottom:1px dashed #e3e3e3;
  align-items:center;
}
.item:last-child{border:none}
.item-name{font-weight:600}
.item-price{font-weight:900;color:#5a0070}
.btn-add{
  background:#5a0070;
  color:#fff;
  border:none;
  border-radius:14px;
  padding:6px 14px;
  font-weight:900;
}

/* CARRINHO */
#cart{
  position:fixed;
  bottom:0;
  left:50%;
  transform:translateX(-50%);
  width:100%;
  max-width:420px;
  background:#fff;
  color:#2b0033;
  padding:18px;
  border-radius:28px 28px 0 0;
  display:none;
  z-index:999;
}
.cart-item{
  display:flex;
  justify-content:space-between;
  margin-bottom:6px;
}
.cart-item strong{color:#5a0070}
</style>
</head>
<body>
<!-- SPLASH -->
<div id="splash">
  <div class="splash-box">
    <img src="logo.png" class="splash-logo">
    <button class="splash-btn" onclick="start()">FAZER PEDIDO</button>
  </div>
</div>

<!-- APP -->
<div id="app">
  <div class="title">Rabika's Burguer</div>
  <div id="closedBanner">üî¥ Estamos fechados ‚Äî Ter√ßa a Domingo das 18:30 √†s 22:30</div>

  <input id="search" class="search" placeholder="Pesquisar no card√°pio...">

  <div class="tabs">
    <div class="tab" onclick="openTab('lanches',this)">üçî Lanches</div>
    <div class="tab" onclick="openTab('porcoes',this)">üçü Por√ß√µes</div>
    <div class="tab" onclick="openTab('pasteis',this)">ü•ü Past√©is</div>
    <div class="tab" onclick="openTab('acai',this)">üç® A√ßa√≠</div>
    <div class="tab" onclick="openTab('bebidas',this)">ü•§ Bebidas</div>
  </div>

  <!-- TODAS AS ABAS INICIAM FECHADAS -->
  <div id="lanches" class="box"></div>
  <div id="porcoes" class="box"></div>
  <div id="pasteis" class="box"></div>
  <div id="acai" class="box"></div>
  <div id="bebidas" class="box"></div>
</div>

<!-- MODAL PAINEL DE PRE√áOS -->
<div id="priceAdminModal" class="modal">
  <div class="modal-box">

    <div class="modal-close" onclick="closePriceAdmin()">‚úï</div>

    <h2 style="text-align:center;color:#5a0070">Painel de Pre√ßos & Card√°pio</h2>
    <p style="text-align:center;font-size:13px;margin-bottom:14px">
      Gerencie produtos ativos, ocultos ou adicione novos itens
    </p>

    <!-- PRODUTOS ATIVOS -->
    <h3 style="margin-top:10px;color:#5a0070">Produtos Ativos</h3>
    <div id="priceAdminActive"></div>

    <!-- PRODUTOS OCULTOS -->
    <h3 style="margin-top:20px;color:#b00020">Produtos Ocultos</h3>
    <div id="priceAdminHidden"></div>

    <!-- NOVO PRODUTO -->
    <h3 style="margin-top:20px;color:#5a0070">+ Novo Produto</h3>

    <input id="newName" class="search" placeholder="Nome do produto">
    <input id="newPrice" class="search" type="number" placeholder="Pre√ßo">

    <select id="newCategory" class="search">
      <option value="">Categoria</option>
      <option value="lanches">Lanches</option>
      <option value="adicionaisLanches">Adicionais</option>
      <option value="porcoes">Por√ß√µes</option>
      <option value="pasteis">Past√©is</option>
      <option value="acaiTamanhos">A√ßa√≠ (Tamanho)</option>
      <option value="acaiAdicionais">A√ßa√≠ (Adicional)</option>
      <option value="bebidas">Bebidas</option>
    </select>

    <button class="btn-green" onclick="addNewProduct()">Adicionar Produto</button>

  </div>
</div>
<script>
/* ================= BUSCA ADMINISTRATIVA ================= */
document.getElementById("search").addEventListener("input",function(){
  const v=this.value.toLowerCase().trim();

  if(v==="pre√ßo" || v==="precos"){
    const s=prompt("Senha do administrador:");
    if(s===ADMIN_PASSWORD) openPriceAdmin();
    this.value="";
    return;
  }

  if(v==="ofertas"){
    const s=prompt("Senha do administrador:");
    if(s===ADMIN_PASSWORD) openOfferAdmin();
    this.value="";
    return;
  }

  /* BUSCA GLOBAL CLIENTE (INALTERADA) */
  let foundTab=null;

  document.querySelectorAll(".item").forEach(i=>{
    const match=i.dataset.name.includes(v);
    i.style.display=match?"grid":"none";
    if(match && !foundTab){
      foundTab=i.closest(".box").id;
    }
  });

  if(foundTab){
    const btn=[...document.querySelectorAll(".tab")]
      .find(t=>t.getAttribute("onclick").includes(foundTab));
    if(btn) openTab(foundTab,btn);
  }
});

/* ================= PAINEL PRE√áOS ================= */
function openPriceAdmin(){
  document.getElementById("priceAdminModal").style.display="flex";
  renderPriceAdmin();
}
function closePriceAdmin(){
  document.getElementById("priceAdminModal").style.display="none";
}

/* ================= RENDER PAINEL ================= */
function renderPriceAdmin(){
  const active=document.getElementById("priceAdminActive");
  const hidden=document.getElementById("priceAdminHidden");
  active.innerHTML="";
  hidden.innerHTML="";

  const all=getAllProducts();

  Object.keys(all).forEach(cat=>{
    all[cat].forEach(p=>{
      const price=getPrice(p);
      const isHidden=productStatus[p.n]===false;

      const html=`
        <div style="margin-bottom:12px">
          <strong>${p.n}</strong>
          <input type="number" class="search" value="${price}" id="price-${p.n}">
          <button class="btn-green" onclick="savePrice('${p.n}')">Salvar</button>
          <button class="btn-gray" onclick="toggleProduct('${p.n}')">
            ${isHidden?"Reativar":"Ocultar"}
          </button>
        </div>
      `;

      if(isHidden) hidden.innerHTML+=html;
      else active.innerHTML+=html;
    });
  });
}

/* ================= SALVAR PRE√áO ================= */
function savePrice(name){
  const val=document.getElementById("price-"+name).value;
  customPrices[name]=parseFloat(val);
  localStorage.setItem("customPrices",JSON.stringify(customPrices));
  renderAll();
}

/* ================= OCULTAR / REATIVAR ================= */
function toggleProduct(name){
  productStatus[name]=productStatus[name]===false?true:false;
  localStorage.setItem("productStatus",JSON.stringify(productStatus));
  renderAll();
}
</script>

<script>
/* ================= CONFIG ================= */
const FREIGHT = 8;
const ADMIN_PASSWORD = "1234";

let cart = [];
let isDelivery = false;

/* üî¥ ALTERA√á√ÉO √öNICA */
let currentTab = null;

/* ================= STORAGE ================= */
let customPrices = JSON.parse(localStorage.getItem("customPrices")) || {};
let productStatus = JSON.parse(localStorage.getItem("productStatus")) || {};
let extraProducts = JSON.parse(localStorage.getItem("extraProducts")) || {};
let sales = JSON.parse(localStorage.getItem("sales")) || [];

/* ================= HOR√ÅRIO ================= */
function isOpen(){
  const d = new Date();
  const day = d.getDay();
  const h = d.getHours() + d.getMinutes()/60;
  if(day === 1) return false;
  if(h < 18.5 || h > 22.5) return false;
  return true;
}

/* ================= PRODUTOS BASE ================= */
const products = {
  lanches:[
    {n:"X-Salada",p:17},{n:"X-Burguer",p:14},{n:"X-Frango",p:22},
    {n:"X-Frango Cremoso",p:20},{n:"X-Bacon",p:25},{n:"X-Calabresa",p:25},
    {n:"X-Cora√ß√£o",p:27},{n:"X-Tudo",p:32},{n:"X-Burguer Duplo",p:22},
    {n:"X-Egg",p:20},{n:"X-Tribom",p:32},{n:"X-Da Casa",p:45},{n:"X-Dog",p:20}
  ],
  adicionaisLanches:[
    {n:"Calabresa",p:7},{n:"Bacon",p:7},{n:"Cora√ß√£o",p:8},
    {n:"Ovo",p:3},{n:"Salsicha",p:4},{n:"Frango",p:7},
    {n:"Cheddar",p:4},{n:"Hamb√∫rguer artesanal",p:10},{n:"Maionese caseira",p:2}
  ],
  porcoes:[
    {n:"Fritas c/ Frango",p:39.99},{n:"Fritas",p:24.99},
    {n:"Fritas c/ Calabresa",p:34.99},{n:"Fritas c/ Bacon",p:34.99},
    {n:"An√©is de Cebola",p:24.99},
    {n:"Fritas c/ Bacon, Calabresa e Queijo",p:39.99},
    {n:"Fritas c/ Bacon Cheddar",p:39.99},
    {n:"Fritas c/ Polenta e Frango",p:39.99},
    {n:"Fritas c/ Polenta",p:24.99},
    {n:"Fritas c/ Calabresa e Catupiry",p:35.99},
    {n:"Fritas, Polenta, Chuleta e Anel de Cebola",p:49.99}
  ],
  pasteis:[
    {n:"Pastel de Carne",p:14},{n:"Pastel de Frango",p:12},
    {n:"Frango Bacon Cheddar",p:16},{n:"Bacon Cheddar",p:15},
    {n:"Calabresa c/ Cebola",p:14},{n:"Carne e Queijo",p:15},
    {n:"Queijo",p:14},{n:"Chocolate ao Leite",p:15},
    {n:"Banana Queijo Canela",p:15},{n:"Romeu e Julieta",p:15},
    {n:"Chocolate Branco",p:15},{n:"Creme e Ouro Branco",p:15},
    {n:"Creme e Sonho de Valsa",p:15}
  ],
  acaiTamanhos:[
    {n:"A√ßa√≠ 300ml",p:12},{n:"A√ßa√≠ 400ml",p:15},{n:"A√ßa√≠ 500ml",p:18}
  ],
  acaiAdicionais:[
    {n:"Pa√ßoca",p:2},{n:"Leite em p√≥",p:4},{n:"Granola",p:4},
    {n:"Morango",p:4},{n:"M&M",p:3},{n:"Ouro Branco",p:3},
    {n:"Banana",p:2},{n:"Sonho de Valsa",p:3},
    {n:"Leite Condensado",p:3},{n:"Nutella",p:4}
  ],
  bebidas:[
    {n:"Cassulinha 200ml",p:3},{n:"Coca-Cola 600ml",p:8},
    {n:"Coca-Cola 2L",p:16},{n:"Refri Lata",p:6},
    {n:"Refrigerante 2L",p:12},{n:"Cerveja Lata 350ml",p:6},
    {n:"Achocolatado 200ml",p:3}
  ]
};
</script>
<script>
/* ================= START ================= */
function start(){
  document.getElementById("splash").style.display="none";
  document.getElementById("app").style.display="block";
  renderAll();
  updateOpenStatus();
}

/* ================= STATUS ABERTO ================= */
function updateOpenStatus(){
  document.getElementById("closedBanner").style.display = isOpen() ? "none" : "block";
}

/* ================= PRODUTOS ================= */
function getAllProducts(){
  let all = JSON.parse(JSON.stringify(products));
  Object.keys(extraProducts).forEach(c=>{
    all[c] = (all[c] || []).concat(extraProducts[c]);
  });
  return all;
}

function getPrice(p){
  return customPrices[p.n] ?? p.p;
}

function renderAll(){
  const all = getAllProducts();
  renderCategory("lanches", all.lanches, all.adicionaisLanches);
  renderCategory("porcoes", all.porcoes);
  renderCategory("pasteis", all.pasteis);
  renderAcai(all);
  renderCategory("bebidas", all.bebidas);
}

function renderCategory(id,list,extra){
  const box = document.getElementById(id);
  box.innerHTML="";
  list.forEach(p=>{
    if(productStatus[p.n] === false) return;
    box.innerHTML += itemHTML(p);
  });
  if(extra){
    box.innerHTML += `<div class="section">‚ûï Adicionais</div>`;
    extra.forEach(p=>{
      if(productStatus[p.n] !== false)
        box.innerHTML += itemHTML(p);
    });
  }
}

function renderAcai(all){
  const box = document.getElementById("acai");
  box.innerHTML = '<div class="section">ü•§ Tamanhos</div>';
  all.acaiTamanhos.forEach(p=>{
    if(productStatus[p.n] !== false)
      box.innerHTML += itemHTML(p);
  });
  box.innerHTML += '<div class="section">üç´ Adicionais</div>';
  all.acaiAdicionais.forEach(p=>{
    if(productStatus[p.n] !== false)
      box.innerHTML += itemHTML(p);
  });
}

function itemHTML(p){
  const price = getPrice(p);
  return `
    <div class="item" data-name="${p.n.toLowerCase()}">
      <span class="item-name">${p.n}</span>
      <span class="item-price">R$ ${price.toFixed(2).replace(".",",")}</span>
      <button class="btn-add" onclick="addItem('${p.n}',${price})">+</button>
    </div>`;
}

/* ================= CARRINHO ================= */
function addItem(n,p){
  if(!isOpen()){
    alert("Estamos fechados no momento.\nTer√ßa a Domingo das 18:30 √†s 22:30");
    return;
  }
  cart.push({n,p});
  updateCart();
}

function updateCart(){
  const box=document.getElementById("cartItems");
  if(!box) return;
  box.innerHTML="";
  let total=0;
  cart.forEach((i,idx)=>{
    total+=i.p;
    box.innerHTML+=`
      <div class="cart-item">
        <strong>${i.n}</strong>
        <span>R$ ${i.p.toFixed(2).replace(".",",")}</span>
        <button onclick="removeItem(${idx})">‚úï</button>
      </div>`;
  });
  if(isDelivery) total+=FREIGHT;
  document.getElementById("total").innerText="Total: R$ "+total.toFixed(2).replace(".",",");
  document.getElementById("cart").style.display = cart.length ? "block" : "none";
}

function removeItem(i){
  cart.splice(i,1);
  updateCart();
}

function setDelivery(v){
  isDelivery=v;
  document.getElementById("address").style.display=v?"block":"none";
  updateCart();
}

/* ================= WHATSAPP ================= */
function sendOrder(){
  let msg = "üçî Pedido Rabika's Burguer\n\n";
  let total = 0;

  cart.forEach(i=>{
    msg += `- ${i.n} R$ ${i.p.toFixed(2).replace(".",",")}\n`;
    total += i.p;
  });

  if(isDelivery){
    msg += "\nEntrega: R$ 8,00\n";
    total += FREIGHT;
  }else{
    msg += "\nRetirada no local\n";
  }

  msg += `\nTotal: R$ ${total.toFixed(2).replace(".",",")}`;

  sales.push({
    date:new Date().toISOString(),
    total,
    payment:document.getElementById("payment")?.value || "N√£o informado"
  });
  localStorage.setItem("sales",JSON.stringify(sales));

  window.open("https://wa.me/554991789706?text="+encodeURIComponent(msg));
}

/* ================= RELAT√ìRIO ================= */
function showReport(){
  let today = new Date().toISOString().split("T")[0];
  let t=0,d=0,p=0,c=0;

  sales.forEach(s=>{
    if(s.date.startsWith(today)){
      t+=s.total;
      if(s.payment==="Dinheiro")d+=s.total;
      if(s.payment==="Pix")p+=s.total;
      if(s.payment.includes("Cart√£o"))c+=s.total;
    }
  });

  alert(
    "RELAT√ìRIO DO DIA\n\n"+
    "Total: R$ "+t.toFixed(2).replace(".",",")+"\n"+
    "Dinheiro: R$ "+d.toFixed(2).replace(".",",")+"\n"+
    "Pix: R$ "+p.toFixed(2).replace(".",",")+"\n"+
    "Cart√£o: R$ "+c.toFixed(2).replace(".",",")
  );
}

/* ================= TABS ================= */
function openTab(id,el){
  currentTab=id;
  document.querySelectorAll(".box").forEach(b=>b.classList.remove("active"));
  document.getElementById(id).classList.add("active");

  if(el){
    document.querySelectorAll(".tab").forEach(t=>t.classList.remove("active"));
    el.classList.add("active");
  }
}

/* ================= OFFLINE ================= */
window.addEventListener("offline",()=>document.getElementById("offline")?.style.display="flex");
window.addEventListener("online",()=>document.getElementById("offline")?.style.display="none");
</script>

</body>
</html>
